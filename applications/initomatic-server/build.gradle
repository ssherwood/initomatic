plugins {
    id 'kotlin'
    id 'kotlin-spring'
    id 'kotlin-kapt'
    id 'org.springframework.boot'
}

// noinspection GroovyAssignabilityCheck
tasks.withType(org.jetbrains.kotlin.gradle.tasks.KotlinCompile).all {
    sourceCompatibility = JavaVersion.VERSION_1_8
    targetCompatibility = JavaVersion.VERSION_1_8

    kotlinOptions {
        jvmTarget = '1.8'
        freeCompilerArgs = ["-Xjsr305=strict"]
    }
}

springBoot {
    buildInfo {
        properties {
            additional = [
                    'foo': 'bar'
            ]
        }
    }
}

bootJar {
    manifest {
        attributes 'Implementation-Title': 'Initomatic',
                'Implementation-Version': version
    }
}

dependencies {
    compile project(':shared:initomatic-api')
    compile project(':components:blueprints')
    compile project(':components:plugins')
    compile project(':applications:initomatic-client')

    // kotlin
    compile 'org.jetbrains.kotlin:kotlin-stdlib-jdk8'
    compile 'org.jetbrains.kotlin:kotlin-reflect'
    compile 'io.github.microutils:kotlin-logging:1.5.4'
    compile 'com.fasterxml.jackson.module:jackson-module-kotlin'
    compile 'io.github.microutils:kotlin-logging:1.5.4'
    testCompile 'org.jetbrains.kotlin:kotlin-test'
    testCompile 'org.jetbrains.kotlin:kotlin-test-junit'

    // spring boot
    compile 'org.springframework.boot:spring-boot-starter'
    compile 'org.springframework.boot:spring-boot-starter-web'
    compile 'org.springframework.boot:spring-boot-starter-actuator'
    compile 'org.springframework.boot:spring-boot-starter-cache'
    testCompile 'org.springframework.boot:spring-boot-starter-test'

    // other libraries
    compile "org.pf4j:pf4j-update:${pf4jUpdateVersion}"
    compile 'org.apache.commons:commons-lang3'
    compile 'io.minio:minio:4.0.1'

    // tooling
    kapt 'org.springframework.boot:spring-boot-configuration-processor'
    runtime 'org.springframework.boot:spring-boot-devtools'
}
